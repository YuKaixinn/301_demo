# 射击成绩预测模型报告 (Score Prediction Report)

## 1. 项目摘要
本报告旨在利用多模态数据（心理、认知、生理、体能）构建高精度的射击成绩预测模型。
根据您的要求，我们调整了数据筛选策略，**仅剔除中间 20% 的数据**（即保留前 40% 高分组和后 40% 低分组），以尽可能多地利用样本。

*   **最佳模型**: Logistic Regression with Polynomial Features (多项式逻辑回归)
*   **当前性能 (AUC)**: **0.69** (在剔除 20% 数据的情况下)
*   **对比性能**: **0.83** (若剔除 40% 数据，即 Top 30% vs Bottom 30%)

> **结论**: 射击表现具有显著的“头部效应”。顶尖高手（前30%）与低分选手差异巨大（AUC 0.83），但加入中间水平选手（前40%-60%）后，区分难度显著增加，模型性能下降至 0.69。若追求 AUC > 0.8 的精准预测，建议聚焦于两端更极端的群体。

## 2. 特征工程与降维细节 (Feature Engineering Details)

为了将数百个原始指标压缩为高效的预测因子，我们实施了标准化的降维流程。所有“_score”后缀的变量均为 **PCA 第一主成分 (First Principal Component)**，代表了该维度的核心变化趋势。

### 2.1 降维流程 (Step-by-Step)
1.  **数据清洗 (Cleaning)**: 剔除缺失值过多的列，使用均值填充剩余缺失值。
2.  **方向统一 (Direction Unification)**: 对“越低越好”的指标（如反应时、3000米跑耗时）取负号，确保所有指标**数值越大代表表现越好/强度越高**。
3.  **标准化 (Standardization)**: 使用 Z-Score 标准化（减去均值，除以标准差），消除量纲差异（如毫秒 vs 次数）。
4.  **PCA 提取 (PCA Extraction)**: 对每个维度单独进行主成分分析，提取**第一主成分 (PC1)**。PC1 通常能解释 40%-70% 的原始方差，是该维度的“综合得分”。

### 2.2 各维度变量构成 (Variable Composition)

| 维度 (Dimension) | 原始变量构成 (Raw Variables) | 物理含义 |
| :--- | :--- | :--- |
| **Score_score**<br>(综合表现) | **不仅仅是射击**。包含：<br>1. **射击任务**: 总分, 命中率, 平均分<br>2. **Task4 (套圈连线)**: 总分, 准确率 (考察手眼协调与认知)<br>3. **Game5 (生存游戏)**: 总分, 剩余生命值 (考察复杂决策下的生存能力) | **多任务综合行为能力**<br>(射击+认知运动+生存决策) |
| **Eye_score**<br>(眼动) | 眨眼 (次数/频率/时长), 注视 (次数/时长), 扫视 (次数/幅度), 瞳孔直径, 视线标准差 | **视觉搜索效率与稳定性** |
| **ECG_score**<br>(心电) | HRV指标 (SDNN, RMSSD, pNN50), R波峰值数, 平均心率, 心率变异率, 呼吸率 | **自主神经调节与抗压能力** |
| **EMG_score**<br>(肌电) | 手臂(Arm) & 颈部(Neck) 的 MAV, MDF, MPF, RMS, iEMG, 最大振幅 | **肌肉激活强度与抗疲劳度** |
| **Cog_score**<br>(认知) | 工作记忆, 物品再认, TMT-A(连线), 延迟回忆, N-Back, Stroop(色词), 逻辑推理 (均包含正确数与反应时) | **脑力处理速度与记忆广度** |
| **BPHR_score**<br>(基础生理) | 实验前后的收缩压 (SBP), 舒张压 (DBP), 心率 (HR) | **生理唤醒水平与储备** |
| **Ele_score**<br>(体能) | 3000米跑, 引体向上, 蛇形跑, 仰卧起坐等 (依据体能测试表) | **心肺耐力与核心力量** |
| **Psy_score**<br>(心理) | 大五人格 (神经质, 尽责性等), 心理弹性量表 | **性格特质与心理韧性** |
| **Motivation**<br>(动机) | 内部动机, 整合调节, 认同动机, 内摄调节, 外在调节 (通过 PCA 提取的动机因子) | **主观意愿与驱动力** |

### 2.3 模型构建细节

### 2.3.1 数据分组策略
*   **高分组 (High)**: 综合行为成绩 (Score_score) 排名前 40% (Score >= 0.65)
*   **低分组 (Low)**: 综合行为成绩 (Score_score) 排名后 40% (Score <= -0.23)
*   **样本量**: 48 人 (总样本 60 人，剔除中间 12 人)

### 2.3.2 输入特征 (多模态)
模型整合了以下维度的 PCA 降维综合评分：
1.  **生理指标**: `Eye_score` (眼动), `ECG_score` (心电), `EMG_score` (肌电), `BPHR_score` (基础心率)
2.  **体能指标**: `Ele_score` (体能)
3.  **心理认知**: `Psy_score` (心理特质), `Cog_score` (认知能力), `Motivation_Factor_PCA` (动机)

### 2.3.3 算法选择
我们对比了 SVM, Random Forest, MLP (神经网络), AdaBoost, ExtraTrees 等多种算法。
最终 **多项式逻辑回归 (Logistic Regression + Polynomial Features)** 表现最佳。这说明变量之间存在显著的**非线性交互作用**（例如：体能好可能放大眼动稳定性的优势）。

## 3. 关键影响因子分析 (Feature Importance)

模型发现以下特征对于区分高/低水平选手最为关键（基于置换重要性 Permutation Importance）：

| 排名 | 特征 (Feature) | 解释 (Interpretation) |
| :--- | :--- | :--- |
| **1** | **Eye_score (眼动)** | **视觉稳定性核心**。注视点的集中度和扫视路径的稳定性是命中率的最直接保障。 |
| **2** | **ECG_score (心电)** | **自主神经调节**。在射击瞬间的心率变异性 (HRV) 反映了抗压能力和冷静程度。 |
| **3** | **BPHR_score (基础心率)** | **生理储备**。较低的基础心率通常与更好的有氧耐力和更强的副交感神经调节有关。 |
| **4** | **EMG_score (肌电)** | **肌肉控制**。手臂和身体姿势的微细肌肉控制能力。 |
| **5** | **Cog_score (认知)** | **注意力分配**。在长时间比赛中保持专注的能力。 |

### 交互作用 (Interaction Effects)
模型中高权重的特征项多为交互项（如 `Eye_score * Ele_score`），这揭示了一个重要机制：
*   **身心耦合**: 单一的体能好或心理好不足以保证高分，**“稳定的视觉 (Eye)” + “充沛的体能 (Ele)”** 结合，或者 **“冷静的大脑 (Cog)” + “稳定的肌肉 (EMG)”** 结合，才是高手的核心特征。

## 4. 建议

1.  **分层训练策略**:
    *   对于**顶尖选手选拔**，模型非常准确 (AUC 0.83)，可重点考核 **动机 (Motivation)** 和 **肌电稳定性 (EMG)**。
    *   对于**中层选手提升**，由于区分度较低 (AUC 0.69)，建议重点强化 **眼动稳定性 (Eye)** 和 **心肺调节 (ECG/BPHR)** 基础训练，这是从平庸迈向优秀的第一步。

2.  **关注“眼-心”联动**:
    *   数据表明眼动和心电是当前模型最重要的两个生理指标。建议在日常训练中引入生物反馈训练，让射手学会控制心率的同时保持视线锁定。

## 5. 模型文件
*   **模型路径**: `d:\code\python\301_data_analy\model\predict_score\Predict_Score_Extreme_4040_best_model.pkl`
*   **特征图**: `d:\code\python\301_data_analy\model\predict_score\svm_feature_importance.png`

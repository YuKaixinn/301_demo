<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>sEMG 分析平台</title>
  <script src="libs/echarts.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  
  <!-- Sidebar -->
  <nav id="sidebar">
    <div class="logo">Rehab System</div>
    <ul class="nav-links">
      <li class="nav-item active" data-page="questionnaire">
        <span>📝</span> 问卷调查
      </li>
      <li class="nav-item" data-page="emg">
        <span>🩺</span> 生理参数采集
      </li>
      <li class="nav-item" data-page="analysis">
        <span>📊</span> 数据分析
      </li>
      <li class="nav-item" data-page="model">
        <span>🤖</span> 模型预测
      </li>
      <li class="nav-item" data-page="settings">
        <span>⚙️</span> 系统设置
      </li>
    </ul>
  </nav>

  <!-- Main Content -->
  <div id="main-content">
    <header>
      <div id="header-title">问卷调查</div>
      <div class="window-controls">
        <button id="minBtn" class="win-btn" title="最小化">
          <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M11 5.5H0" stroke="currentColor" stroke-width="1.2"/>
          </svg>
        </button>
        <button id="maxBtn" class="win-btn" title="最大化">
          <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="0.6" y="0.6" width="9.8" height="9.8" stroke="currentColor" stroke-width="1.2"/>
          </svg>
        </button>
        <button id="closeBtn" class="win-btn close" title="关闭">
          <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M0.6 0.6L10.4 10.4" stroke="currentColor" stroke-width="1.2"/>
            <path d="M10.4 0.6L0.6 10.4" stroke="currentColor" stroke-width="1.2"/>
          </svg>
        </button>
      </div>
    </header>

    <div class="content-area">
      
      <!-- 生理参数采集 Page (软件启动 + 生理记录) -->
      <div id="page-emg" class="page">
        <!-- 软件启动 -->
        <div class="modern-card">
          <h3 style="margin-bottom: 20px; font-size: 18px; color: #333;">启动实验任务</h3>
          <div class="launch-grid">
            <div class="launch-card">
              <div class="launch-icon">💪</div>
              <div class="launch-title">肌电采集 (EMG)</div>
              <button id="launchEmgBtn" class="modern-btn btn-primary">🚀 启动软件</button>
            </div>
            <div class="launch-card">
              <div class="launch-icon">💓</div>
              <div class="launch-title">心电采集 (ECG)</div>
              <button id="launchEcgBtn" class="modern-btn btn-primary">🚀 启动软件</button>
            </div>
            <div class="launch-card">
              <div class="launch-icon">👁️</div>
              <div class="launch-title">眼动采集 (Eye)</div>
              <button id="launchEyeBtn" class="modern-btn btn-primary">🚀 启动软件</button>
            </div>
          </div>
        </div>

        <!-- 血压与心率记录 -->
        <div class="modern-card" id="physio-section">
          <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 1px solid #f3f4f6;">
            <h3 style="margin:0; font-size: 18px; color: #333;">血压与心率记录</h3>
            <div style="display:flex; gap:12px;">
              <button id="savePhysioBtn" class="modern-btn btn-primary">💾 保存血压与心率</button>
              <button id="listPhysioBtn" class="modern-btn btn-secondary">📜 查看血压历史记录</button>
            </div>
          </div>
          
          <div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
              <!-- Pre-Experiment -->
              <div>
                <h5 style="color: #374151; margin: 0 0 16px 0; font-size: 14px; font-weight: 600;">实验前 (Pre-Experiment)</h5>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;">
                  <div>
                    <label style="display: block; font-size: 12px; color: #6b7280; margin-bottom: 6px;">收缩压 (SBP)</label>
                    <input type="number" id="pre_sbp" placeholder="mmHg" class="modern-input">
                  </div>
                  <div>
                    <label style="display: block; font-size: 12px; color: #6b7280; margin-bottom: 6px;">舒张压 (DBP)</label>
                    <input type="number" id="pre_dbp" placeholder="mmHg" class="modern-input">
                  </div>
                  <div>
                    <label style="display: block; font-size: 12px; color: #6b7280; margin-bottom: 6px;">心率 (HR)</label>
                    <input type="number" id="pre_hr" placeholder="bpm" class="modern-input">
                  </div>
                </div>
              </div>

              <!-- Post-Experiment -->
              <div>
                <h5 style="color: #374151; margin: 0 0 16px 0; font-size: 14px; font-weight: 600;">实验后 (Post-Experiment)</h5>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;">
                  <div>
                    <label style="display: block; font-size: 12px; color: #6b7280; margin-bottom: 6px;">收缩压 (SBP)</label>
                    <input type="number" id="post_sbp" placeholder="mmHg" class="modern-input">
                  </div>
                  <div>
                    <label style="display: block; font-size: 12px; color: #6b7280; margin-bottom: 6px;">舒张压 (DBP)</label>
                    <input type="number" id="post_dbp" placeholder="mmHg" class="modern-input">
                  </div>
                  <div>
                    <label style="display: block; font-size: 12px; color: #6b7280; margin-bottom: 6px;">心率 (HR)</label>
                    <input type="number" id="post_hr" placeholder="bpm" class="modern-input">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="physio-list" class="modern-card" style="display: none; padding-top: 20px;">
          <h3 style="margin-bottom: 16px; font-size: 18px;">历史记录</h3>
          <div id="physio-list-content" style="font-size:14px; color:#374151;"></div>
        </div>
      </div>

      <!-- Questionnaire Page -->
      <div id="page-questionnaire" class="page active">
        <div id="questionnaire-form" class="modern-card" style="display: none;">
          <h3 style="margin-bottom: 20px; font-size: 18px; color: #333;">问卷填写</h3>
          
          <div id="basic-info-section" style="border-bottom: 1px solid #eee; margin-bottom: 24px; padding-bottom: 20px;">
            <h4 style="margin-top: 0; margin-bottom: 20px; color: #4b5563; font-size: 16px; font-weight: 600;">基本信息 (Basic Information)</h4>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
              <div>
                <label style="display: block; font-weight: 500; margin-bottom: 8px; font-size: 14px; color: #374151;">被试编号 (Subject ID) <span style="color:red">*</span></label>
                <input type="text" id="basic_subject_id" placeholder="e.g. 24380101" class="modern-input">
              </div>
              <div>
                <label style="display: block; font-weight: 500; margin-bottom: 8px; font-size: 14px; color: #374151;">姓名 (Name)</label>
                <input type="text" id="basic_name" class="modern-input">
              </div>
              <div>
                <label style="display: block; font-weight: 500; margin-bottom: 8px; font-size: 14px; color: #374151;">性别 (Gender)</label>
                <select id="basic_gender" class="modern-input">
                  <option value="">请选择 (Select)</option>
                  <option value="male">男 (Male)</option>
                  <option value="female">女 (Female)</option>
                </select>
              </div>
              <div>
                <label style="display: block; font-weight: 500; margin-bottom: 8px; font-size: 14px; color: #374151;">年龄 (Age)</label>
                <input type="number" id="basic_age" class="modern-input">
              </div>
              <div>
                <label style="display: block; font-weight: 500; margin-bottom: 8px; font-size: 14px; color: #374151;">学历 (Education)</label>
                <select id="basic_education" class="modern-input">
                  <option value="">请选择 (Select)</option>
                  <option value="elementary">小学 (Elementary)</option>
                  <option value="middle">初中 (Middle)</option>
                  <option value="high">高中 (High School)</option>
                  <option value="bachelor">本科 (Bachelor)</option>
                  <option value="master">硕士 (Master)</option>
                  <option value="phd">博士 (PhD)</option>
                  <option value="other">其他 (Other)</option>
                </select>
              </div>
            </div>
          </div>

          <h4 style="margin-top: 0; margin-bottom: 20px; color: #4b5563; font-size: 16px; font-weight: 600;">问卷内容</h4>

          <div id="questionnaire-fields"></div>
          <div id="questionnaire-error" style="display:none;color:#b91c1c;background:#fee2e2;border:1px solid #fecaca;padding:8px 12px;border-radius:6px;margin:16px 0 8px 0;"></div>

          <div style="display:flex; justify-content:flex-end; gap:12px; margin-top:24px;">
            <button id="resetQuestionnaireBtn" class="modern-btn" style="background-color: #f59e0b; color: white;">↺ 重置</button>
            <button id="saveQuestionnaireBtn" class="modern-btn btn-primary">💾 提交</button>
          </div>
        </div>
        <div id="questionnaire-result" class="modern-card" style="display: none;">
          <h3 style="margin-bottom: 16px; font-size: 18px; color: #333;">问卷数据</h3>
          <pre id="questionnaire-content" style="background: #f8fafc; padding: 15px; border-radius: 8px; overflow-x: auto; border: 1px solid #e2e8f0;"></pre>
        </div>
        <div id="answers-list" class="modern-card" style="display: none;">
          <h3 style="margin-bottom: 16px; font-size: 18px; color: #333;">历史记录</h3>
          <div id="answers-list-content" style="font-size:14px;color:#374151;"></div>
        </div>
      </div>


      <!-- 数据分析 Page -->
      <div id="page-analysis" class="page">
        <!-- 问卷数据分析 (新增雷达图) -->
        <div class="modern-card">
          <h3 style="margin-bottom: 12px; font-size: 18px; color: #333;">问卷分析 (Questionnaire)</h3>
          <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">根据问卷结果生成可视化雷达图。</p>
          <div style="display: flex; gap: 12px;">
            <button id="analyzeQuestionnaireBtn" class="modern-btn btn-primary">📊 生成雷达图</button>
          </div>
          
          <div id="questionnaire-analysis-results" class="results-container" style="display:none; margin-top: 24px; border-top: 1px solid #e2e8f0; padding-top: 20px;">
            <h4 style="margin-bottom: 16px; color: #4b5563;">分析结果</h4>
            <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 20px;">
              <div id="questionnaire-radar-bigfive" style="flex: 1; min-width: 350px; height: 400px;"></div>
              <div id="questionnaire-radar-psycap" style="flex: 1; min-width: 350px; height: 400px;"></div>
            </div>
            <div id="questionnaire-table-container" style="width: 100%;"></div>
          </div>
        </div>

        <!-- ECG 数据分析 -->
        <div class="modern-card">
          <h3 style="margin-bottom: 12px; font-size: 18px; color: #333;">心电数据分析 (ECG)</h3>
          <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">导入 ECG 数据文件进行心率变异性分析。</p>
          <div style="display: flex; gap: 12px;">
            <button id="analyzeEcgBtn" class="modern-btn btn-primary">📂 导入数据</button>
            <button id="exportEcgBtn" class="modern-btn btn-secondary">💾 保存结果</button>
          </div>
          
          <div id="ecg-results" class="results-container" style="display:none; margin-top: 24px; border-top: 1px solid #e2e8f0; padding-top: 20px;">
            <h4 style="margin-bottom: 16px; color: #4b5563;">分析结果</h4>
            <div id="ecg-metrics" class="metrics-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;"></div>
            <div id="ecg-charts" style="width: 100%; height: 400px; margin-top: 24px;"></div>
          </div>
        </div>

        <!-- EMG 数据分析 -->
        <div class="modern-card">
          <h3 style="margin-bottom: 12px; font-size: 18px; color: #333;">肌电数据分析 (EMG)</h3>
          <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">导入 ASC 数据文件进行特征提取。</p>
          <div style="display: flex; gap: 12px;">
            <button id="analyzeEmgBtn" class="modern-btn btn-primary">📂 导入数据</button>
            <button id="exportEmgBtn" class="modern-btn btn-secondary">💾 保存结果</button>
          </div>
          
          <div id="emg-results" class="results-container" style="display:none; margin-top: 24px; border-top: 1px solid #e2e8f0; padding-top: 20px;">
            <h4 style="margin-bottom: 16px; color: #4b5563;">分析结果</h4>
            <div id="emg-metrics" class="metrics-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;"></div>
            <div id="emg-charts" style="width: 100%; height: 400px; margin-top: 24px;"></div>
          </div>
        </div>

        <!-- 眼动数据分析 -->
        <div class="modern-card">
          <h3 style="margin-bottom: 12px; font-size: 18px; color: #333;">眼动数据分析 (Eye Tracking)</h3>
          <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">导入眼动数据进行注视点分析。</p>
          <div style="display: flex; gap: 12px;">
            <button id="analyzeEyeBtn" class="modern-btn btn-primary">📂 导入数据</button>
            <button id="exportEyeBtn" class="modern-btn btn-secondary">💾 保存结果</button>
          </div>
          
          <div id="eye-results" class="results-container" style="display:none; margin-top: 24px; border-top: 1px solid #e2e8f0; padding-top: 20px;">
            <h4 style="margin-bottom: 16px; color: #4b5563;">分析结果</h4>
            <div id="eye-metrics" class="metrics-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;"></div>
            <div id="eye-charts-container" style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 24px;"></div>
          </div>
        </div>

        <!-- 游戏成绩分析 -->
        <div class="modern-card">
          <div class="action-bar" style="margin-bottom: 0;">
            <h3 style="margin-bottom: 20px; font-size: 18px; color: #333;">游戏成绩分析 (Game Performance)</h3>
            <div style="display: flex; gap: 12px; margin-bottom: 20px;">
              <button id="analyzeGameBtn" class="modern-btn btn-primary">🚀 自动分析</button>
              <button id="saveGameBtn" class="modern-btn" style="background-color: #10b981; color: white;">💾 保存结果</button>
              <button id="listGameBtn" class="modern-btn btn-secondary">📜 查看历史</button>
            </div>
          </div>

          <div id="game-results" style="display:block; margin-top:20px; padding-top: 20px; border-top: 1px solid #e2e8f0;">
            <h4 style="margin-bottom: 16px; color: #4b5563;">分析结果详情</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
              <!-- Shooting -->
              <div style="background:#f8fafc; padding:20px; border-radius:12px; border: 1px solid #e2e8f0;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                  <h5 style="margin:0; color:#2563eb; font-size: 16px;">射击游戏 (game 3)</h5>
                  <button id="importShootingBtn" class="modern-btn btn-secondary" style="padding: 4px 10px; font-size: 12px;">📂 导入</button>
                </div>
                <p style="margin: 8px 0; color: #475569;">总分: <strong id="val_shooting_total" style="color: #0f172a;">-</strong></p>
                <p style="margin: 8px 0; color: #475569;">命中率: <strong id="val_shooting_accuracy" style="color: #0f172a;">-</strong></p>
                <p style="margin: 8px 0; color: #475569;">平均分: <strong id="val_shooting_avg" style="color: #0f172a;">-</strong></p>
              </div>
              <!-- Task 4 -->
              <div style="background:#f8fafc; padding:20px; border-radius:12px; border: 1px solid #e2e8f0;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                  <h5 style="margin:0; color:#2563eb; font-size: 16px;">套圈与连线 (game 4)</h5>
                  <button id="importTask4Btn" class="modern-btn btn-secondary" style="padding: 4px 10px; font-size: 12px;">📂 导入</button>
                </div>
                <p style="margin: 8px 0; color: #475569;">套圈分: <strong id="val_task4_ball" style="color: #0f172a;">-</strong></p>
                <p style="margin: 8px 0; color: #475569;">连线分: <strong id="val_task4_line" style="color: #0f172a;">-</strong></p>
                <p style="margin: 8px 0; color: #475569;">总分: <strong id="val_task4_total" style="color: #0f172a;">-</strong></p>
                <p style="margin: 8px 0; color: #475569;">得分率: <strong id="val_task4_accuracy" style="color: #0f172a;">-</strong></p>
              </div>
              <!-- Game 5 -->
              <div style="background:#f8fafc; padding:20px; border-radius:12px; border: 1px solid #e2e8f0;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                  <h5 style="margin:0; color:#2563eb; font-size: 16px;">综合生存 (game 5)</h5>
                  <button id="importGame5Btn" class="modern-btn btn-secondary" style="padding: 4px 10px; font-size: 12px;">📂 导入</button>
                </div>
                <p style="margin: 8px 0; color: #475569;">总分: <strong id="val_game5_total" style="color: #0f172a;">-</strong></p>
                <p style="margin: 8px 0; color: #475569;">剩余生命: <strong id="val_game5_life" style="color: #0f172a;">-</strong></p>
              </div>
            </div>
          </div>
          
          <div id="game-list" class="modern-card" style="display: none; margin-top: 24px; box-shadow: none; border: 1px solid #e2e8f0;">
            <h3 style="margin-bottom: 16px; font-size: 18px; color: #333;">历史记录</h3>
            <div id="game-list-content" style="font-size:14px;color:#374151;"></div>
          </div>
        </div>
      </div>

      <!-- Model Prediction Page -->
      <div id="page-model" class="page">
        <div class="modern-card">
          <h3 style="margin-bottom: 20px; font-size: 18px; color: #333;">模型预测（Ele_Level）</h3>
          <p style="color:#64748b; margin-bottom:16px; font-size:14px;">
            基于线下训练好的 Ele_Level 高AUC模型，根据当前被试的多模态数据进行在线预测。
          </p>

          <div style="display:flex; gap:12px; align-items:center; margin-bottom:20px;">
            <input type="text" id="prediction-subject-id" placeholder="被试编号，例如 24380101"
                   class="modern-input" style="max-width:240px;">
            <button id="run-prediction-btn" class="modern-btn btn-primary">🚀 运行 Ele_Level 预测</button>
          </div>

          <div id="prediction-result" style="display:none; margin-top:20px; padding-top:16px; border-top:1px solid #e5e7eb;">
            <h4 style="margin:0 0 12px 0; color:#374151;">预测结果</h4>
            <p id="prediction-output" style="font-size:14px; color:#111827;"></p>
            <p id="prediction-prob" style="font-size:13px; color:#4b5563; margin-top:8px;"></p>
            <p id="prediction-note" style="font-size:12px; color:#6b7280; margin-top:12px;">
              当前模型基于 Ele_Level_Custom_Weighted_Optimized_Extreme_1515_best_model.pkl（AUC≈0.80），结合问卷、生理、游戏等多模态指标进行预测。
            </p>
          </div>
        </div>

        <div class="modern-card" style="margin-top:24px;">
          <h3 style="margin-bottom: 20px; font-size: 18px; color: #333;">模型预测（认知优势类型 Cog_Type）</h3>
          <p style="color:#64748b; margin-bottom:16px; font-size:14px;">
            使用 HybridOvRClassifier（记忆强 / 执行强 / 推理强），基于线下训练好的 Cog_Type_HybridOvR_best_model.pkl，对当前被试的认知优势类型进行预测。
          </p>

          <div style="display:flex; gap:12px; align-items:center; margin-bottom:20px;">
            <input type="text" id="cog-prediction-subject-id" placeholder="被试编号，例如 24380101"
                   class="modern-input" style="max-width:240px;">
            <button id="run-cog-prediction-btn" class="modern-btn btn-primary">🧠 预测认知优势类型</button>
          </div>

          <div id="cog-prediction-result" style="display:none; margin-top:20px; padding-top:16px; border-top:1px solid #e5e7eb;">
            <h4 style="margin:0 0 12px 0; color:#374151;">认知优势预测结果</h4>
            <p id="cog-prediction-output" style="font-size:14px; color:#111827;"></p>
            <p id="cog-prediction-prob" style="font-size:13px; color:#4b5563; margin-top:8px;"></p>
          </div>
        </div>

        <div class="modern-card" style="margin-top:24px;">
          <h3 style="margin-bottom: 20px; font-size: 18px; color: #333;">模型预测（动机类型与水平）</h3>
          <p style="color:#64748b; margin-bottom:16px; font-size:14px;">
            基于 Motivation_Type_Classification_best_model.pkl 和 Motivation_Level_Extreme_4040_best_model.pkl，
            结合问卷、生理与游戏行为特征，对当前被试的动机类型与自主动机水平进行预测。
          </p>

          <div style="display:flex; gap:12px; align-items:center; margin-bottom:20px;">
            <input type="text" id="mot-prediction-subject-id" placeholder="被试编号，例如 24380101"
                   class="modern-input" style="max-width:240px;">
            <button id="run-mot-type-btn" class="modern-btn btn-primary">🔥 预测动机类型</button>
            <button id="run-mot-level-btn" class="modern-btn btn-secondary">📈 预测动机水平</button>
          </div>

          <div id="mot-type-result" style="display:none; margin-top:16px; padding-top:16px; border-top:1px solid #e5e7eb;">
            <h4 style="margin:0 0 12px 0; color:#374151;">动机类型预测结果</h4>
            <p id="mot-type-output" style="font-size:14px; color:#111827;"></p>
            <p id="mot-type-prob" style="font-size:13px; color:#4b5563; margin-top:8px;"></p>
          </div>

          <div id="mot-level-result" style="display:none; margin-top:16px; padding-top:16px; border-top:1px solid #e5e7eb;">
            <h4 style="margin:0 0 12px 0; color:#374151;">自主动机水平预测结果</h4>
            <p id="mot-level-output" style="font-size:14px; color:#111827;"></p>
            <p id="mot-level-prob" style="font-size:13px; color:#4b5563; margin-top:8px;"></p>
            <p id="mot-level-score" style="font-size:13px; color:#4b5563; margin-top:4px;"></p>
          </div>
        </div>
      </div>

      <!-- Settings Page -->
      <div id="page-settings" class="page">
        <div class="modern-card">
          <h3 style="margin-bottom: 20px; font-size: 18px; color: #333;">常规设置</h3>
          <div style="margin-top: 15px; display: flex; flex-direction: column; gap: 12px;">
            <label style="display: flex; align-items: center; gap: 8px; color: #374151; font-size: 14px;">
              <input type="checkbox" checked style="width: 16px; height: 16px;"> 启用硬件加速
            </label>
            <label style="display: flex; align-items: center; gap: 8px; color: #374151; font-size: 14px;">
              <input type="checkbox" style="width: 16px; height: 16px;"> 启动时自动最大化
            </label>
          </div>
        </div>

        <div class="modern-card">
          <h3 style="margin-bottom: 20px; font-size: 18px; color: #333;">外部软件路径配置</h3>
          
          <div class="config-item" style="margin-top: 20px;">
            <p style="margin-bottom: 8px; color: #4b5563; font-weight: 500; font-size: 14px;">EMG 软件路径：</p>
            <div style="display: flex; gap: 12px;">
              <input type="text" id="emgPathInput" readonly class="modern-input" style="flex: 1;">
              <button id="browseEmgPathBtn" class="modern-btn btn-secondary">浏览...</button>
            </div>
            <p style="margin-bottom: 8px; margin-top: 16px; color: #4b5563; font-weight: 500; font-size: 14px;">EMG 数据输出目录：</p>
            <div style="display: flex; gap: 12px;">
              <input type="text" id="emgDataPathInput" readonly class="modern-input" style="flex: 1;">
              <button id="browseEmgDataPathBtn" class="modern-btn btn-secondary">浏览...</button>
            </div>
          </div>

          <div class="config-item" style="margin-top: 24px; border-top: 1px solid #e2e8f0; padding-top: 20px;">
            <p style="margin-bottom: 8px; color: #4b5563; font-weight: 500; font-size: 14px;">ECG 软件路径：</p>
            <div style="display: flex; gap: 12px;">
              <input type="text" id="ecgPathInput" readonly class="modern-input" style="flex: 1;">
              <button id="browseEcgPathBtn" class="modern-btn btn-secondary">浏览...</button>
            </div>
            <p style="margin-bottom: 8px; margin-top: 16px; color: #4b5563; font-weight: 500; font-size: 14px;">ECG 数据输出目录：</p>
            <div style="display: flex; gap: 12px;">
              <input type="text" id="ecgDataPathInput" readonly class="modern-input" style="flex: 1;">
              <button id="browseEcgDataPathBtn" class="modern-btn btn-secondary">浏览...</button>
            </div>
          </div>

          <div class="config-item" style="margin-top: 24px; border-top: 1px solid #e2e8f0; padding-top: 20px;">
            <p style="margin-bottom: 8px; color: #4b5563; font-weight: 500; font-size: 14px;">眼动软件路径：</p>
            <div style="display: flex; gap: 12px;">
              <input type="text" id="eyePathInput" readonly class="modern-input" style="flex: 1;">
              <button id="browseEyePathBtn" class="modern-btn btn-secondary">浏览...</button>
            </div>
            <p style="margin-bottom: 8px; margin-top: 16px; color: #4b5563; font-weight: 500; font-size: 14px;">眼动数据输出目录：</p>
            <div style="display: flex; gap: 12px;">
              <input type="text" id="eyeDataPathInput" readonly class="modern-input" style="flex: 1;">
              <button id="browseEyeDataPathBtn" class="modern-btn btn-secondary">浏览...</button>
            </div>
          </div>
        </div>
        
        <div class="modern-card">
          <h3 style="margin-bottom: 20px; font-size: 18px; color: #333;">操作中心</h3>
          <div style="margin-top: 15px;">
            <button id="exportUnifiedCsvBtn" class="modern-btn btn-primary">📊 导出统一 CSV</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Custom Modal Overlay -->
  <div id="custom-modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; align-items: center; justify-content: center;">
    <div style="background: white; padding: 20px 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 400px; width: 90%; text-align: center;">
      <h3 id="custom-modal-title" style="margin-top: 0; color: #333;">提示</h3>
      <p id="custom-modal-message" style="color: #666; margin: 15px 0; line-height: 1.5;"></p>
      <button id="custom-modal-close-btn" style="background: #2563eb; color: white; border: none; padding: 8px 20px; border-radius: 4px; cursor: pointer; font-size: 14px;">确定</button>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
